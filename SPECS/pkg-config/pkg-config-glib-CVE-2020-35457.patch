diff -ru a/glib/goption.c b/glib/goption.c
--- a/glib/goption.c	2021-01-14 23:44:20.902552896 +0000
+++ b/glib/goption.c	2021-01-14 23:45:06.351609441 +0000
@@ -2148,6 +2148,8 @@
 
   for (n_entries = 0; entries[n_entries].long_name != NULL; n_entries++) ;
 
+  g_return_if_fail (n_entries <= G_MAXSIZE - group->n_entries);
+  
   group->entries = g_renew (GOptionEntry, group->entries, group->n_entries + n_entries);
 
   memcpy (group->entries + group->n_entries, entries, sizeof (GOptionEntry) * n_entries);
