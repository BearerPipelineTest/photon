From 297db6ce4d1d53037993701d989fd0ab3f2b99c3 Mon Sep 17 00:00:00 2001
From: Stefan Sperling <stsp@apache.org>
Date: Fri, 29 Jan 2021 13:17:15 +0000
Subject: [PATCH] Fix a potential NULL dereference in the config file parser.

* subversion/libsvn_repos/config_file.c
  (get_repos_config): svn_repos_find_root_path() may return NULL.
   Check the return value accordingly.


git-svn-id: https://svn.apache.org/repos/asf/subversion/trunk@1886019 13f79535-47bb-0310-9956-ffa450edef68
---
 subversion/libsvn_repos/config_file.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/subversion/libsvn_repos/config_file.c b/subversion/libsvn_repos/config_file.c
index 4bec766e3dd5d..31b9441ca0da3 100644
--- a/subversion/libsvn_repos/config_file.c
+++ b/subversion/libsvn_repos/config_file.c
@@ -237,6 +237,10 @@ get_repos_config(svn_stream_t **stream,
     {
       /* Search for a repository in the full path. */
       repos_root_dirent = svn_repos_find_root_path(dirent, scratch_pool);
+      if (repos_root_dirent == NULL)
+        return svn_error_trace(handle_missing_file(stream, checksum, access,
+                                                   url, must_exist,
+                                                   svn_node_none));
 
       /* Attempt to open a repository at repos_root_dirent. */
       SVN_ERR(svn_repos_open3(&access->repos, repos_root_dirent, NULL,
