Patch taken from https://bugs.ntp.org/attachment.cgi?id=1709&action=diff&context=patch&collapsed=&headers=1&format=raw

diff -Nru a/libntp/a_md5encrypt.c b/libntp/a_md5encrypt.c
--- a/libntp/a_md5encrypt.c	2020-04-01 16:49:50.572836334 +0200
+++ b/libntp/a_md5encrypt.c	2020-04-01 16:49:50.573836302 +0200
@@ -93,7 +93,7 @@
 		}
 	  cmac_fail:
 		if (ctx)
-			CMAC_CTX_cleanup(ctx);
+			CMAC_CTX_free(ctx);
 	}
 	else
 #   endif /*ENABLE_CMAC*/
diff -Nru a/sntp/crypto.c b/sntp/crypto.c
--- a/sntp/crypto.c	2020-04-01 16:49:50.573836302 +0200
+++ b/sntp/crypto.c	2020-04-01 16:49:50.573836302 +0200
@@ -70,7 +70,8 @@
 		}
 		len = (u_int)slen;
 		
-		CMAC_CTX_cleanup(ctx);
+		if (ctx)
+			CMAC_CTX_free(ctx);
 		/* Test our AES-128-CMAC implementation */
 		
 	} else	/* MD5 MAC handling */
