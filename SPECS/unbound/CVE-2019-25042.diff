From 6c3a0b54ed8ace93d5b5ca7b8078dc87e75cd640 Mon Sep 17 00:00:00 2001
From: "W.C.A. Wijngaards" <wouter@nlnetlabs.nl>
Date: Tue, 3 Dec 2019 16:18:47 +0100
Subject: [PATCH] - Fix Out of Bound Write Compressed Names in rdata_copy(),  
 reported by X41 D-Sec.

Signed-off-by: Shreyas B <shreyasb@vmware.com>
---
 util/data/msgreply.c | 2 +-
 1 files changed, 1 insertions(+), 1 deletion(-)

diff --git a/util/data/msgreply.c b/util/data/msgreply.c
index a2c09ac20..4320f312d 100644
--- a/util/data/msgreply.c
+++ b/util/data/msgreply.c
@@ -243,10 +243,10 @@ rdata_copy(sldns_buffer* pkt, struct packed_rrset_data* data, uint8_t* to,
 				break;
 			}
 			if(len) {
+				log_assert(len <= pkt_len);
 				memmove(to, sldns_buffer_current(pkt), len);
 				to += len;
 				sldns_buffer_skip(pkt, (ssize_t)len);
-				log_assert(len <= pkt_len);
 				pkt_len -= len;
 			}
 			rdf++;
