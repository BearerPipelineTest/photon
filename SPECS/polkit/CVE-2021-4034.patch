diff -ru a/src/programs/pkcheck.c b/src/programs/pkcheck.c
--- a/src/programs/pkcheck.c	2015-06-18 20:20:50.000000000 +0000
+++ b/src/programs/pkcheck.c	2022-01-24 10:19:10.162029858 +0000
@@ -361,6 +361,11 @@
   revoke_temp = FALSE;
   local_agent_handle = NULL;
   ret = 126;
+  if (argc < 1)
+    {
+	help();
+	exit(1);
+    }
 
   g_type_init ();
 
diff -ru a/src/programs/pkexec.c b/src/programs/pkexec.c
--- a/src/programs/pkexec.c	2015-06-18 20:20:50.000000000 +0000
+++ b/src/programs/pkexec.c	2022-01-24 10:36:53.550623452 +0000
@@ -490,6 +490,16 @@
   pid_t pid_of_caller;
   gpointer local_agent_handle;
 
+  /*
+   * If 'pkexec' is called wrong, just show help and bail out.
+   */
+  if (argc<1)
+    {
+      clearenv();
+      usage(argc, argv);
+      exit(1);
+    }
+
   ret = 127;
   authority = NULL;
   subject = NULL;
@@ -635,7 +645,15 @@
           goto out;
         }
       g_free (path);
-      argv[n] = path = s;
+      path = s;
+
+      /* argc<2 and pkexec runs just shell, argv is guaranteed to be null-terminated.
+       * /-less shell shouldn't happen, but let's be defensive and don't write to null-termination
+       */
+      if (argv[n] != NULL)
+      {
+        argv[n] = path;
+      }
     }
   if (access (path, F_OK) != 0)
     {
